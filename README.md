# TransBrain: A computational framework for translating brain-wide phenotypes between humans and mice

Despite remarkable advances in whole-brain imaging technologies, the lack of quantitative approaches to bridge rodent preclinical and human studies remains a critical challenge. We developed TransBrain, an integrated computational framework for bidirectional translation of brain-wide phenotypes between humans and mice.


## TransBrain Mapping Strategy

The development of TransBrain comprises three core steps:

1. **Spatial Transcriptome Matching** – We trained a detached deep neural network model based on the integrated human transcriptomic data (spatially resolved microarray data and large-scale single-nucleus RNA sequencing data) to learn region-specific latent embeddings generalizable to mice. 
2. **Graph-Based Random Walk** – Construction of a heterogeneous brain-region network to capture inter-species connectivity relationships, whihc generates latent embeddings that integrate transcriptomic, connectivity, and anatomical hierarchical correspondence information. 
3. **Mapping via Latent Representations** – Employing a dual regression approach to enable the bidirectional translation of whole-brain patterns,such as imaging phenotypes, establishing a unified latent space for cross-species analysis.

What can TransBrain do?
1. **xxx**
2. **xxx**



This framework provides a systematic approach for cross-species quantitative comparison and mechanistic investigation of both normal and pathological brain functions. 

![fig1](/Figure/fig1.png)


### Further Reading

If you wish to learn more about the construction details of this method, please refer to our article: [https://www.biorxiv.org/content/10.1101/2025.01.27.635016v1](https://www.biorxiv.org/content/10.1101/2025.01.27.635016v1) (in preprint).



## Getting Started

If you want to learn about the process of building this framework, you can refer to the [**Method and Evaluation**](#method-and-evaluation) sections.  

Additionally, we provide [**Tutorial Cases**](#tutorial-cases) demonstrating how to apply TransBrain for cross-species mapping of neural circuits or disease phenotypes.  

If you just want to know a straightforward way to perform cross-species mapping in your project, go to [**Quick Start**](#quick-start).




## [Method and Analysis](./Method/README.md)
### Files
* [TR_embeddings](./Method/TRembeddings): The region-specific transcriptional embeddings generated by the detached model.

  * [MixData_Cortical_Train_Repeat1000](./Method/TRembeddings/FinalModels/MixData_Cortical_Train_Repeat1000): The cortical embeddings derived from repeated models. We generated 100 integrated transcriptomic datasets, each undergoing 10 repeated model training to enhance robustness and stability.

  * [MixData_SubCortical_Train_Repeat1000](./Method/TRembeddings/FinalModels/MixData_SubCortical_Train_Repeat1000): The subcortical embeddings derived from repeated models.

* [Graphembeddings](./TransBrain/Graphembeddings): Graph embeddings of Human-Mouse generated using Random Random walk-based graph representation algorithms.

* [atlas](./TransBrain/atlas): Human and mouse atlas, templates, and corresponding csv files used in this project.

* [sc_matrix](./TransBrain/sc_matrix): Human DTI matrix and mouse tracer matrix used for the construction of heterogeneous graph.


### Steps
* [TRembeddings analysis](./Method/TRembeddings_analysis/embeddings_analysis.ipynb): Evaluating the cross-species correspondence of TR embeddings.

![fig3](./Figure/fig2.png) fig2待补充

* [Cross-species gradients comparison](./Method/TRembeddings_analysis/cross-species_gradient.ipynb): Evaluating the cross-species correspondence of conserved transcriptional gradients.
![fig3](./Figure/fig3.png)

* [Generate graph embedding](./Method/generate_graph_embeddings): code to generate graph embeddings.
  * [Human_Mouse_embeddings](./Method/generate_graph_embeddings/Human_Mouse_Embedding.ipynb): notebook to generate Human-Mouse Graph.
  * [Connectome-embeddings](./Method/generate_graph_embeddings/Connectome-embeddings): the source node embedding code was provided by [Gideon Rosenthal et al](https://www.nature.com/articles/s41467-018-04614-w).
![fig4](./Figure/fig4.png)

* [Graph embedding analysis](./Method/Graphembedding_analysis): Comparison of embedding similarities.
![fig4cf](./Figure/fig4cf.png)


## [Tutorial Cases](./Tutorials/README.md)
* [Translation of optogenetic circuits](./Transbrain_new/Method/Mouse_to_Human):  Translation of mouse optogenetic circuits to human brain function.
![fig6](./Figure/fig6.png)

* [Assessment of autism risk mechanisms across species](./Transbrain_new/Method/Mouse_to_Human):  Linked gene mutations to imaging phenotypes  deviations in autism.
![fig7](./Figure/fig7.png)

/data100/home/tyzhang/Transbrain-main/Transbrain_new/Method/Mouse_to_Human/Transcode.ipynb 需要拆分为两个


## Quick Start

This section provides a quick guide to using **TransBrain** for cross-species brain region mapping.

### Dependencies

Ensure you have the required dependencies installed. You can install them using the provided `requirements.txt` file:

```sh
pip install -r requirements.txt
```

Alternatively, if you want to install packages manually, TransBrain requires:

- Python >= 3.8
- NumPy
- SciPy
- PyTorch
- Pandas
...
---

### Installation and Usage

TransBrain can be used in two ways:

### ** Simple Use (Copy & Run)**

If you prefer not to install the package, you can directly copy the `TransBrain` directory into your project’s root folder and import it as follows:

```python
from TransBrain import trans_mouse_to_human, trans_human_to_mouse

# Convert mouse brain data to human brain mapping
human_data = trans_mouse_to_human(mouse_data)

# Convert human brain data to mouse brain mapping
mouse_data = trans_human_to_mouse(human_data)
```

---

### ** Install via pip**

To install TransBrain as a package, run:

```sh
pip install TransBrain
```

Then, import and use it in your script:

```python
import TransBrain as TB

# Perform cross-species mapping
human_data = TB.trans_mouse_to_human(mouse_data)
mouse_data = TB.trans_human_to_mouse(human_data)
```

This allows seamless integration into your existing workflows. 🚀

